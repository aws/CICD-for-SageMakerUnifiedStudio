name: Slack Action Failure Notification

on:
  workflow_run:
    workflows:
      - "Deploy Dashboard Glue QuickSight"
      - "Deploy Data Notebooks"
      - "Deploy GenAI"
      - "Deploy ML Deployment"
      - "Deploy ML Training"
      - "Translate Documentation"
    types: [completed]

permissions:
  contents: read

jobs:
  notify:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    steps:
      - name: Send Slack failure notification
        run: |
          curl -X POST ${{ secrets.SLACK_FAILURE_WEBHOOK_URL }} \
            -H "Content-Type: application/json" \
            -d "{\"workflow\": \"${{ github.event.workflow_run.name }}\", 
            \"run_url\": \"${{ github.event.workflow_run.html_url }}\"}"
